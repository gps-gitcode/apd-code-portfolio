---
title: "Final_report"
author: "Gangaprasad Shahapurkar"
date: "April 4, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE)
```


## Introduction 

In this final report we are supposed to apply the learnings from the course on one of the datasets provided.

```{r message=FALSE, echo=FALSE, warning=FALSE}
library(readr) #read files from disk
library(tidyverse) #data manipulation 
library(cluster) #clustering algorithms

```

## Step 1 - Dataset selection
The dataset that we will be working on as part of this report will be 
**Bike Vendors**
Let us read the dataset and populate in a dataframe **df**

```{r}
df <- read_csv("../Data/bikeVendors.csv") # Read the data
names(df) <- make.names(names(df)) # Removing extra column spaces
```
## Step 2 - Epicycle analysis of data
We will be applying all 5 core activities of epicycle analysis of data as part of the final report. Below are 5 core activities that are performed as part of data analaysis.

1. Stating and refining the question
2. Exploring the data
3. Building formal statistical models
4. Interpreting the results
5. Communicating the results

Let us take step by step approach to work on the dataset choosen. Begining with step 1, let us set the expectation about the data 

## Step 3 - Data Description 
The selected dataset **Bike Vendors** has **97** observations and **35** variables. It is seen that out of 35 variables **4** variables are of type **char** and remaining variables are **numeric**

Below are the column names of the dataset

```{r echo=FALSE}
names(df)
```

The first 5 variables in the dataset **"model", "category1", "category2", "frame", "price"**  define model, type of bike and their sale price. The remaining 30 variables are vendors of these bikes and observations listed are the price distribution for these models.

Based on the data we can find answers to some of the below questions

1) Which category has more bike options?
2) Which are Top 5 costlier bikes and Top 5 cheaper bikes ?
1) Which vendor sells bike at cheapest price ?
2) Which vendor sells bike at same price as MSRP ?


## Step 4 - Data Exploration
### Exploratory plots and descriptions 
As we noticed this dataset has categorization of bikes, their price and their price distribution at different vendors. Let us explore the data based on different factors

There are 2 broad categories of bikes based on type of frame. As we can see that there more number of models available of frame type carbon than Aluminum

```{r}
table(df$frame) %>% barplot(col="wheat", xlab = "Type of Frame", ylab = "Number of Bikes")
```

**Average bike price based on frame type**

```{r echo = FALSE}
df %>% 
  group_by(frame) %>% 
  summarise(mean(price))
```

In addition to frame, there are also 2 more factors based on which bikes are categorized. It is category1 and Category2. Below is the summary of bike based on different category 

```{r echo = FALSE}
count(df,frame,category1,category2)
```
There is largest collection of bikes available in **Cross Country Race** category which are **Carbon** frame based **Mountain bikes**. This answers our question 1. We can also see that there are only 2 bike option available in **Fat Bike** category which **Aluminum** frame based **Mountain bikes**  

```{r}
boxplot(df$price~df$frame, main="Price range based on frame", xlab="Frame type", ylab = "Price", col="blue", border = "orange")

```

The above boxplot shows the price distribution based on frame type. It can be seen that data for frame type "Aluminum" is normally distributed, but there is greater variation in the price for bikes of frame type "Carbon".  There are 2 outlier points we can see ecah in both the category.  


```{r}
hist(df$price, col="darkorange", border="dodgerblue", breaks = 30, main = "Histogram of Price Distribution", xlab = "Price", ylab = "Count")
rug(df$price)

```

If we see the overall distribution of the price we can noticed that more number of bike options are available in price range of say 1500 to 4000.

```{r}
g_bike <- ggplot(df, aes(category2, fill = frame))
g_bike + geom_bar(position = position_stack(reverse = TRUE)) + ggtitle("Bikes based on Category2 type") + coord_flip()
```

### Cluster analysis
For cluster analysis let us create copy of original data set and nullify all the categorical variables

```{r}
df_cluster <- df[,6:10] #create copy of original data set
dim(df_cluster) #dimension before

#Apply k-means cluster
clus_output <- kmeans(df_cluster,3)
clus_output

clus_output$size
clus_output$cluster

#Plot the clusters with different color as the model
plot(df_cluster, col=clus_output$cluster)

```

### Regression analysis
```{r}
df1 <- df
df1 <- mutate_at(df1, vars(model,category1, category2,frame), as.factor)
plot(price~San.Francisco.Cruisers, data=df1)
mean.df1 = mean(df1$price)
abline(h=mean.df1)
lmodel = lm(price~San.Francisco.Cruisers, data=df1)
summary(lmodel)
plot(lmodel)
```


## Results